<script>
  $(function() {
    $('.lessons').sortable({
      update: function( event, ui ) {
        $.ajax({
          type: 'PUT',
          url: ui.item.data('update-url'),
          dataType: 'json',
          data: { lesson: { row_order_position: ui.item.index() } }
        });
      }
    });
   });
</script>
<br />
<div class="booyah-box col-xs-offset-1 col-xs-10">
	<h1 class="text-center"><%= current_course.title %></h1>
	<%= image_tag current_course.image, :class => 'img-responsive' %>
	<br />
	<%= link_to 'Preview as a Student', course_path(current_course), :class => 'btn btn-warning pull-right' %>
	<div class="clear"></div>
	<div class="text-center">
		<%= link_to 'Add a new Section', new_instructor_course_section_path(current_course), :class => 'btn btn-primary btn-large' %>
	</div>
	<ul>
		<% current_course.sections.each do |section| %>
		<li>
			<%= section.title %>
			<%= link_to 'New lesson', new_instructor_section_lesson_path(section), :class => 'btn btn-primary pull-right btn-xs' %>
			<br class="clear"/>
			<ul class="lessons">
				<% section.lessons.rank(:row_order).each do |lesson| %>
				<li data-update-url="<%= instructor_lesson_path(lesson) %>" >
					<b><%= lesson.title %></b>
					-
					<%= lesson.subtitle %>
				</li>
				<% end %>
			</ul>
			<br class="clear" />
		</li>
		<% end %>
	</ul>
</div>